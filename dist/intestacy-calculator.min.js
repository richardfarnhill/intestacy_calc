!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).IntestacyWidget=t()}(this,(function(){"use strict";class e{constructor(){this.STATUTORY_LEGACY=322e3,this.state={name:null,estateValue:null,married:null,children:null,grandchildren:null,greatGrandchildren:null,parentsAlive:null,siblings:null,fullSiblings:null,halfSiblings:null,grandparents:null,auntsUncles:null,fullAuntsUncles:null,halfAuntsUncles:null,currentQuestion:0,childrenDeceased:null,deceasedChildrenHadChildren:null,siblingsDeceasedWithChildren:null,auntsUnclesDeceasedWithChildren:null},this.questions=[{id:"married",text:"Are you married or in a civil partnership?"},{id:"children",text:"Do you have any children?"},{id:"childrenDeceased",text:"Are any of your children deceased?"},{id:"deceasedChildrenHadChildren",text:"Did any of your deceased children have children of their own?"},{id:"parentsAlive",text:"Are either of your parents alive?"},{id:"siblings",text:"Do you have any siblings?"},{id:"fullSiblings",text:"Do you have any full siblings (same two parents)?"},{id:"siblingsDeceasedWithChildren",text:"Are any of your siblings deceased with children of their own?"},{id:"halfSiblings",text:"Do you have any half siblings (one shared parent)?"},{id:"grandchildren",text:"Do you have any grandchildren?"},{id:"greatGrandchildren",text:"Do you have any great-grandchildren?"},{id:"grandparents",text:"Do you have any living grandparents?"},{id:"auntsUncles",text:"Do you have any living aunts or uncles?"},{id:"fullAuntsUncles",text:"Do you have any full aunts or uncles (siblings of your parents)?"},{id:"auntsUnclesDeceasedWithChildren",text:"Are any of your aunts or uncles deceased with children of their own?"},{id:"halfAuntsUncles",text:"Do you have any half aunts or uncles (half-siblings of your parents)?"}],this.questionMap=this.createQuestionMap(),this.questionFlow=this.defineQuestionFlow()}createQuestionMap(){const e={};return this.questions.forEach((t=>{e[t.id]=t})),e}defineQuestionFlow(){return{married:e=>"children",children:e=>e?"childrenDeceased":"parentsAlive",childrenDeceased:e=>e?"deceasedChildrenHadChildren":null,deceasedChildrenHadChildren:e=>null,parentsAlive:e=>e?null:"siblings",siblings:e=>e?"fullSiblings":"grandchildren",fullSiblings:e=>e?"siblingsDeceasedWithChildren":"halfSiblings",siblingsDeceasedWithChildren:e=>null,halfSiblings:e=>null,grandchildren:e=>e?null:"greatGrandchildren",greatGrandchildren:e=>e?null:"grandparents",grandparents:e=>e?null:"auntsUncles",auntsUncles:e=>e?"fullAuntsUncles":null,fullAuntsUncles:e=>e?"auntsUnclesDeceasedWithChildren":"halfAuntsUncles",auntsUnclesDeceasedWithChildren:e=>null,halfAuntsUncles:e=>null}}validateEstateValue(e){try{return null==e?{isValid:!1,errorMessage:"Please enter your estate value"}:(e=parseFloat(e),isNaN(e)?{isValid:!1,errorMessage:"Please enter a valid number"}:e<=0?{isValid:!1,errorMessage:"Your estate value must be greater than £0"}:{isValid:!0,errorMessage:""})}catch(e){return{isValid:!1,errorMessage:"Please enter a valid number"}}}formatCurrency(e){return new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP"}).format(e)}calculateDistribution(){const e=parseFloat(this.state.estateValue),t=this.formatCurrency(e);if(this.state.married){if(this.state.children){if(e<=this.STATUTORY_LEGACY)return`Your entire estate of ${t} will pass to your spouse/civil partner.`;const n=e-this.STATUTORY_LEGACY,s=this.STATUTORY_LEGACY+n/2,i=n/2,a=this.state.childrenDeceased?"living children and the children of your deceased children (who will share their parent's portion per stirpes)":"children";return`Your estate will be distributed as follows:\n• Your spouse/civil partner will receive: ${this.formatCurrency(s)}\n  - First ${this.formatCurrency(this.STATUTORY_LEGACY)} as statutory legacy\n  - Plus ${this.formatCurrency(n/2)} (half of the remainder)\n• Your ${a} will share: ${this.formatCurrency(i)}`}return`Your entire estate of ${t} will pass to your spouse/civil partner.`}if(this.state.children){return`Your entire estate of ${t} will be divided equally between your ${this.state.childrenDeceased?"living children and the children of your deceased children (who will share their parent's portion per stirpes)":"children"}.`}if(this.state.parentsAlive)return`Your entire estate of ${t} will pass to your surviving parent(s) in equal shares.`;if(this.state.siblings){if(this.state.fullSiblings){return`Your entire estate of ${t} will be divided equally between your ${"full siblings"}${this.state.siblingsDeceasedWithChildren?" (their children will inherit their share per stirpes)":""}.`}if(this.state.halfSiblings)return`Your entire estate of ${t} will be divided equally between your half-siblings.`}if(this.state.grandchildren)return`Your entire estate of ${t} will be divided equally between your grandchildren.`;if(this.state.greatGrandchildren)return`Your entire estate of ${t} will be divided equally between your great-grandchildren.`;if(this.state.grandparents)return`Your entire estate of ${t} will be divided equally between your grandparents.`;if(this.state.auntsUncles){if(this.state.fullAuntsUncles){return`Your entire estate of ${t} will be divided equally between your ${"aunts and uncles"}${this.state.auntsUnclesDeceasedWithChildren?" (their children will inherit their share per stirpes)":""}.`}if(this.state.halfAuntsUncles)return`Your entire estate of ${t} will be divided equally between your half-aunts and half-uncles.`}return`Your estate of ${t} will pass to the Crown (Bona Vacantia).`}processAnswer(e,t){if(this.state[e]=t,this.questionFlow[e]){return this.questionFlow[e](t)}return null}getQuestionText(e){return this.questionMap[e]?this.questionMap[e].text:"Unknown question"}canDetermineDistribution(){return!(!this.state.married||this.state.children)||(this.state.children?null!==this.state.childrenDeceased&&(!this.state.childrenDeceased||null!==this.state.deceasedChildrenHadChildren):[null!==this.state.parentsAlive&&this.state.parentsAlive,null!==this.state.fullSiblings&&this.state.fullSiblings,null!==this.state.halfSiblings&&this.state.halfSiblings,null!==this.state.grandchildren&&this.state.grandchildren,null!==this.state.greatGrandchildren&&this.state.greatGrandchildren,null!==this.state.grandparents&&this.state.grandparents,null!==this.state.fullAuntsUncles&&this.state.fullAuntsUncles,null!==this.state.halfAuntsUncles&&this.state.halfAuntsUncles].some((e=>e)))}}class t{constructor(t,n={}){if(this.container="string"==typeof t?document.querySelector(t):t,!this.container)throw new Error("Container element not found");this.options={theme:"light",contactInfo:"Please contact us to discuss creating a Will.",...n},this.calculator=new e,this.state={currentStep:"name",questionId:null,name:"",estateValue:null},this.elements={},this.init()}init(){this.createUIStructure(),this.addEventListeners(),this.applyTheme(),this.showNameInput()}createUIStructure(){this.container.innerHTML="",this.container.classList.add("intestacy-calculator");const e=document.createElement("div");e.className="intestacy-header",e.innerHTML="\n      <h1>UK Intestacy Calculator</h1>\n      <p>Find out how your estate would be distributed if you die without a will</p>\n    ",this.container.appendChild(e);const t=document.createElement("div");t.className="intestacy-content",this.container.appendChild(t),this.elements.content=t;const n=document.createElement("div");n.className="intestacy-section intestacy-name-section",n.innerHTML='\n      <label for="intestacy-name">What is your name?</label>\n      <input type="text" id="intestacy-name" placeholder="Enter your full name">\n      <div class="intestacy-error" id="intestacy-name-error"></div>\n    ',t.appendChild(n),this.elements.nameSection=n,this.elements.nameInput=n.querySelector("#intestacy-name"),this.elements.nameError=n.querySelector("#intestacy-name-error");const s=document.createElement("div");s.className="intestacy-section intestacy-estate-section",s.innerHTML='\n      <label for="intestacy-estate">What is the approximate value of your estate (£)?</label>\n      <input type="number" id="intestacy-estate" placeholder="Enter value in pounds">\n      <div class="intestacy-error" id="intestacy-estate-error"></div>\n    ',t.appendChild(s),this.elements.estateSection=s,this.elements.estateInput=s.querySelector("#intestacy-estate"),this.elements.estateError=s.querySelector("#intestacy-estate-error");const i=document.createElement("div");i.className="intestacy-section intestacy-status-section",i.innerHTML='\n      <label>What is your relationship status?</label>\n      <div class="intestacy-radio-group">\n        <label>\n          <input type="radio" name="intestacy-status" value="single"> Single\n        </label>\n        <label>\n          <input type="radio" name="intestacy-status" value="married"> Married/Civil Partnership\n        </label>\n        <label>\n          <input type="radio" name="intestacy-status" value="divorced"> Divorced\n        </label>\n        <label>\n          <input type="radio" name="intestacy-status" value="widowed"> Widowed\n        </label>\n      </div>\n    ',t.appendChild(i),this.elements.statusSection=i,this.elements.statusInputs=i.querySelectorAll('input[name="intestacy-status"]');const a=document.createElement("div");a.className="intestacy-section intestacy-question-section",a.innerHTML='\n      <div class="intestacy-question" id="intestacy-question-text"></div>\n      <div class="intestacy-radio-group">\n        <label>\n          <input type="radio" name="intestacy-answer" value="Yes"> Yes\n        </label>\n        <label>\n          <input type="radio" name="intestacy-answer" value="No"> No\n        </label>\n      </div>\n    ',t.appendChild(a),this.elements.questionSection=a,this.elements.questionText=a.querySelector("#intestacy-question-text"),this.elements.answerInputs=a.querySelectorAll('input[name="intestacy-answer"]');const l=document.createElement("div");l.className="intestacy-section intestacy-result-section",l.innerHTML='\n      <div class="intestacy-result" id="intestacy-result"></div>\n      <div class="intestacy-next-steps">\n        <h2>What Next?</h2>\n        <p>Having a proper Will is the only way to ensure your estate is distributed according to your wishes.</p>\n        <div id="intestacy-contact-info"></div>\n      </div>\n    ',t.appendChild(l),this.elements.resultSection=l,this.elements.result=l.querySelector("#intestacy-result"),this.elements.contactInfo=l.querySelector("#intestacy-contact-info");const r=document.createElement("div");r.className="intestacy-buttons",r.innerHTML='\n      <button type="button" id="intestacy-continue">Continue</button>\n      <button type="button" id="intestacy-restart">Start Again</button>\n    ',this.container.appendChild(r),this.elements.continueButton=r.querySelector("#intestacy-continue"),this.elements.restartButton=r.querySelector("#intestacy-restart");const o=document.createElement("div");o.className="intestacy-footer",o.innerHTML="\n      <p><strong>Legal Disclaimer:</strong> This calculator provides guidance based on UK intestacy rules. \n      For legal advice, please consult a qualified professional.</p>\n    ",this.container.appendChild(o),this.elements.estateSection.style.display="none",this.elements.statusSection.style.display="none",this.elements.questionSection.style.display="none",this.elements.resultSection.style.display="none"}addEventListeners(){this.elements.continueButton.addEventListener("click",(()=>{this.handleContinue()})),this.elements.restartButton.addEventListener("click",(()=>{this.handleRestart()})),this.elements.nameInput.addEventListener("keypress",(e=>{"Enter"===e.key&&this.handleContinue()})),this.elements.estateInput.addEventListener("keypress",(e=>{"Enter"===e.key&&this.handleContinue()}))}applyTheme(){this.container.classList.add(`intestacy-theme-${this.options.theme}`)}showNameInput(){this.state.currentStep="name",this.elements.nameSection.style.display="block",this.elements.estateSection.style.display="none",this.elements.statusSection.style.display="none",this.elements.questionSection.style.display="none",this.elements.resultSection.style.display="none",this.elements.nameInput.focus()}showEstateInput(){this.state.currentStep="estate",this.elements.nameSection.style.display="none",this.elements.estateSection.style.display="block",this.elements.statusSection.style.display="none",this.elements.questionSection.style.display="none",this.elements.resultSection.style.display="none",this.elements.estateInput.focus()}showStatusInput(){this.state.currentStep="status",this.elements.nameSection.style.display="none",this.elements.estateSection.style.display="none",this.elements.statusSection.style.display="block",this.elements.questionSection.style.display="none",this.elements.resultSection.style.display="none"}showQuestion(e){this.state.currentStep="question",this.state.questionId=e,this.elements.questionText.textContent=this.calculator.getQuestionText(e),this.elements.answerInputs.forEach((e=>{e.checked=!1})),this.elements.nameSection.style.display="none",this.elements.estateSection.style.display="none",this.elements.statusSection.style.display="none",this.elements.questionSection.style.display="block",this.elements.resultSection.style.display="none"}showResult(){const e=this.calculator.calculateDistribution(),t=`\n      <h2>Distribution Results for ${this.state.name}</h2>\n      <p>${e}</p>\n      <p>If you wish to change this distribution, you will need to create a Will.</p>\n    `;this.elements.result.innerHTML=t,this.elements.contactInfo.textContent=this.options.contactInfo,this.elements.nameSection.style.display="none",this.elements.estateSection.style.display="none",this.elements.statusSection.style.display="none",this.elements.questionSection.style.display="none",this.elements.resultSection.style.display="block"}handleContinue(){switch(this.state.currentStep){case"name":this.handleNameSubmit();break;case"estate":this.handleEstateSubmit();break;case"status":this.handleStatusSubmit();break;case"question":this.handleQuestionAnswer()}}handleNameSubmit(){const e=this.elements.nameInput.value,t=(n=e)&&""!==n.trim()?n.trim().length<2?{isValid:!1,errorMessage:"Name must be at least 2 characters"}:{isValid:!0,errorMessage:""}:{isValid:!1,errorMessage:"Please enter your name"};var n;t.isValid?(this.elements.nameError.textContent="",this.state.name=e,this.showEstateInput()):this.elements.nameError.textContent=t.errorMessage}handleEstateSubmit(){const e=this.elements.estateInput.value,t=function(e){try{if(null==e||""===e)return{isValid:!1,errorMessage:"Please enter your estate value"};const t="string"==typeof e?parseFloat(e):e;return isNaN(t)?{isValid:!1,errorMessage:"Please enter a valid number"}:t<=0?{isValid:!1,errorMessage:"Your estate value must be greater than £0"}:{isValid:!0,errorMessage:""}}catch(e){return{isValid:!1,errorMessage:"Please enter a valid number"}}}(e);t.isValid?(this.elements.estateError.textContent="",this.state.estateValue=parseFloat(e),this.showStatusInput()):this.elements.estateError.textContent=t.errorMessage}handleStatusSubmit(){let e=null;this.elements.statusInputs.forEach((t=>{t.checked&&(e=t.value)})),e&&(this.calculator.state.name=this.state.name,this.calculator.state.estateValue=this.state.estateValue,this.calculator.state.married="married"===e,this.showQuestion("children"))}handleQuestionAnswer(){let e=null;if(this.elements.answerInputs.forEach((t=>{t.checked&&(e=t.value)})),!e)return;const t=this.state.questionId,n="Yes"===e;this.calculator.state[t]=n;const s=this.calculator.processAnswer(t,n);s?this.showQuestion(s):this.showResult()}handleRestart(){this.calculator=new e,this.state={currentStep:"name",questionId:null,name:"",estateValue:null},this.elements.nameInput.value="",this.elements.estateInput.value="",this.elements.nameError.textContent="",this.elements.estateError.textContent="",this.elements.statusInputs.forEach((e=>{e.checked=!1})),this.showNameInput()}}class n{constructor(e={}){this.options={container:"#intestacy-calculator",theme:"light",contactInfo:"Please contact us to discuss creating a Will.",...e},this.init()}init(){this.loadStyles(),this.ui=new t(this.options.container,this.options)}loadStyles(){if(document.getElementById("intestacy-calculator-styles"))return;const e=document.createElement("style");e.id="intestacy-calculator-styles",e.textContent=this.getStyles(),document.head.appendChild(e)}getStyles(){return'\n      /**\n       * Intestacy Calculator Styles\n       */\n      \n      /* Base styles */\n      .intestacy-calculator {\n        font-family: Arial, sans-serif;\n        max-width: 800px;\n        margin: 0 auto;\n        padding: 20px;\n        box-sizing: border-box;\n      }\n      \n      .intestacy-calculator * {\n        box-sizing: border-box;\n      }\n      \n      /* Header */\n      .intestacy-header {\n        margin-bottom: 30px;\n        text-align: center;\n      }\n      \n      .intestacy-header h1 {\n        font-size: 28px;\n        margin: 0 0 10px 0;\n        color: #333;\n      }\n      \n      .intestacy-header p {\n        font-size: 16px;\n        margin: 0;\n        color: #666;\n      }\n      \n      /* Content sections */\n      .intestacy-content {\n        background-color: #f9f9f9;\n        border-radius: 8px;\n        padding: 20px;\n        margin-bottom: 20px;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n      }\n      \n      .intestacy-section {\n        margin-bottom: 20px;\n      }\n      \n      /* Form elements */\n      .intestacy-calculator label {\n        display: block;\n        font-size: 16px;\n        font-weight: bold;\n        margin-bottom: 8px;\n        color: #333;\n      }\n      \n      .intestacy-calculator input[type="text"],\n      .intestacy-calculator input[type="number"] {\n        width: 100%;\n        padding: 10px;\n        font-size: 16px;\n        border: 1px solid #ccc;\n        border-radius: 4px;\n        margin-bottom: 5px;\n      }\n      \n      .intestacy-calculator input[type="text"]:focus,\n      .intestacy-calculator input[type="number"]:focus {\n        border-color: #007bff;\n        outline: none;\n        box-shadow: 0 0 0 2px rgba(0, 123, 255, 0.25);\n      }\n      \n      /* Radio buttons */\n      .intestacy-radio-group {\n        margin-top: 10px;\n      }\n      \n      .intestacy-radio-group label {\n        display: block;\n        font-weight: normal;\n        margin-bottom: 10px;\n        cursor: pointer;\n      }\n      \n      .intestacy-radio-group input[type="radio"] {\n        margin-right: 8px;\n      }\n      \n      /* Error messages */\n      .intestacy-error {\n        color: #dc3545;\n        font-size: 14px;\n        margin-top: 5px;\n        min-height: 20px;\n      }\n      \n      /* Question section */\n      .intestacy-question {\n        font-size: 18px;\n        margin-bottom: 15px;\n        color: #333;\n      }\n      \n      /* Result section */\n      .intestacy-result {\n        background-color: #fff;\n        padding: 20px;\n        border-radius: 5px;\n        margin-bottom: 20px;\n        border-left: 4px solid #007bff;\n      }\n      \n      .intestacy-result h2 {\n        font-size: 22px;\n        margin-top: 0;\n        margin-bottom: 15px;\n        color: #333;\n      }\n      \n      .intestacy-result p {\n        margin-bottom: 15px;\n        line-height: 1.5;\n      }\n      \n      .intestacy-next-steps {\n        margin-top: 20px;\n      }\n      \n      .intestacy-next-steps h2 {\n        font-size: 20px;\n        margin-top: 0;\n        margin-bottom: 10px;\n        color: #333;\n      }\n      \n      /* Buttons */\n      .intestacy-buttons {\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 20px;\n      }\n      \n      .intestacy-calculator button {\n        padding: 10px 20px;\n        font-size: 16px;\n        border: none;\n        border-radius: 4px;\n        cursor: pointer;\n        transition: background-color 0.2s;\n      }\n      \n      #intestacy-continue {\n        background-color: #007bff;\n        color: white;\n      }\n      \n      #intestacy-continue:hover {\n        background-color: #0069d9;\n      }\n      \n      #intestacy-restart {\n        background-color: #6c757d;\n        color: white;\n      }\n      \n      #intestacy-restart:hover {\n        background-color: #5a6268;\n      }\n      \n      /* Footer */\n      .intestacy-footer {\n        font-size: 14px;\n        color: #666;\n        text-align: center;\n        margin-top: 30px;\n        padding-top: 15px;\n        border-top: 1px solid #eee;\n      }\n      \n      /* Light theme (default) */\n      .intestacy-theme-light {\n        /* Default styles are already light theme */\n      }\n      \n      /* Dark theme */\n      .intestacy-theme-dark {\n        background-color: #333;\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-header h1 {\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-header p {\n        color: #ccc;\n      }\n      \n      .intestacy-theme-dark .intestacy-content {\n        background-color: #444;\n        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n      }\n      \n      .intestacy-theme-dark .intestacy-calculator label {\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-calculator input[type="text"],\n      .intestacy-theme-dark .intestacy-calculator input[type="number"] {\n        background-color: #555;\n        border-color: #666;\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-question {\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-result {\n        background-color: #555;\n        border-left-color: #0d6efd;\n      }\n      \n      .intestacy-theme-dark .intestacy-result h2 {\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-next-steps h2 {\n        color: #f5f5f5;\n      }\n      \n      .intestacy-theme-dark .intestacy-footer {\n        color: #ccc;\n        border-top-color: #555;\n      }\n      \n      /* Responsive styles */\n      @media (max-width: 768px) {\n        .intestacy-calculator {\n          padding: 15px;\n        }\n        \n        .intestacy-header h1 {\n          font-size: 24px;\n        }\n        \n        .intestacy-content {\n          padding: 15px;\n        }\n        \n        .intestacy-buttons {\n          flex-direction: column;\n          gap: 10px;\n        }\n        \n        .intestacy-calculator button {\n          width: 100%;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        .intestacy-header h1 {\n          font-size: 22px;\n        }\n        \n        .intestacy-question {\n          font-size: 16px;\n        }\n        \n        .intestacy-result h2 {\n          font-size: 20px;\n        }\n      }\n    '}reset(){this.ui&&this.ui.handleRestart()}updateOptions(e={}){this.options={...this.options,...e},this.init()}}return"undefined"!=typeof window&&(window.IntestacyWidget=n),n}));
//# sourceMappingURL=intestacy-calculator.min.js.map
